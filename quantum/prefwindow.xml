<?xml version="1.0"?>
<bindings id="handyClicks-prefwindowBindings" xmlns="http://www.mozilla.org/xbl">
	<binding id="prefwindow" extends="chrome://handyclicks-quantum/content/preferences.xml#prefwindow">
		<implementation>
			<!-- Forbid browser.preferences.animateFadeIn (we have buggy tree pane resizing) -->
			<field name="_shouldAnimate">false</field>
			<field name="_hcInstantApply">undefined</field>
			<property name="instantApply">
				<getter>
				<![CDATA[
					var instantApply = this._hcInstantApply;
					if(instantApply === undefined) {
						instantApply = false; // Fallback value
						try {
							var prefs = Components.classes["@mozilla.org/preferences-service;1"]
								.getService(Components.interfaces.nsIPrefBranch);
							var ovr = prefs.getIntPref("extensions.handyclicks.sets.overrideInstantApply");
							if(ovr == -1)
								instantApply = prefs.getBoolPref("browser.preferences.instantApply");
							else
								instantApply = !!ovr;
						}
						catch(e) {
							Components.utils.reportError(e);
						}
						this._hcInstantApply = instantApply;
					}
					return instantApply;
				]]>
				</getter>
				<setter>
				</setter>
			</property>
		</implementation>
	</binding>
	<binding id="preferences" extends="chrome://handyclicks-quantum/content/preferences.xml#preferences">
		<implementation>
			<property name="instantApply"
				onget="return document.documentElement.instantApply;"
				onset="" />
		</implementation>
	</binding>
</bindings>